!function(e){function t(t){for(var s,n,o=t[0],d=t[1],l=t[2],h=0,u=[];h<o.length;h++)n=o[h],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&u.push(a[n][0]),a[n]=0;for(s in d)Object.prototype.hasOwnProperty.call(d,s)&&(e[s]=d[s]);for(c&&c(t);u.length;)u.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],s=!0,o=1;o<i.length;o++){var d=i[o];0!==a[d]&&(s=!1)}s&&(r.splice(t--,1),e=n(n.s=i[0]))}return e}var s={},a={1:0},r=[];function n(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=s,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./";var o=window.webpackJsonp=window.webpackJsonp||[],d=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=d;r.push([14,0,2]),i()}({14:function(e,t,i){e.exports=i(40)},40:function(e,t,i){"use strict";i.r(t);i(15);var s=i(0);var a=[function(e,t,i){return".center"+t+"{text-align:center}.link"+t+"{border:none;padding:10px;border-radius:5px;text-decoration:none;background-color:#ff6000;color:#fff;margin-left:33%;margin-right:33%;display:inline-block;margin-top:1em}.info"+t+"{color:#000;background-color:#e4f2f8;margin:auto;padding:15px 10px;text-align:left;width:300px;border-radius:5px}.code"+t+"{font-family:monospace;font-size:large}.container"+t+"{margin-top:30px}img"+t+"{max-width:150px}.greeting"+t+"{height:75px}"}];var r=[function(e,t,i){return(i?":host{font-family:Ropa Sans,sans-serif;color:#333;max-width:640px;margin:0 auto;position:relative}":e+"{font-family:Ropa Sans,sans-serif;color:#333;max-width:640px;margin:0 auto;position:relative}")+".loadingMessage"+t+"{text-align:center;padding:40px;background-color:#eee}.canvas"+t+"{width:100%}.output"+t+"{margin-top:20px;background:#eee;padding:10px;padding-bottom:0}.outputDiv"+t+"{padding-bottom:10px;word-wrap:break-word}.noQRFound"+t+"{text-align:center}"}];function n(e,t,i,s){const{h:a,t:r,b:n}=e,{_m0:o}=s;return[a("div",{classMap:{"slds-grid":!0,"slds-wrap":!0,"slds-grid_align-center":!0},key:14},[a("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_2-of-12":!0,"slds-large-size_3-of-12":!0},key:0},[]),a("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_8-of-12":!0,"slds-large-size_6-of-12":!0},key:12},[a("div",{classMap:{"slds-align_absolute-center":!0},key:11},[a("div",{attrs:{"data-id":"divCapture"},key:3},[a("div",{classMap:{loadingMessage:!0},attrs:{"data-id":"loadingMessage"},key:1},[r("ðŸŽ¥ Unable to access video stream (please make sure you have a webcam enabled)")]),a("canvas",{classMap:{canvas:!0},attrs:{"data-id":"canvas"},props:{hidden:!0},key:2},[])]),a("div",{attrs:{"data-id":"divData"},props:{hidden:!0},key:10},[a("button",{classMap:{"slds-button":!0,"slds-button_brand":!0},key:4,on:{click:o||(s._m0=n(t.scanAgain))}},[r("Scan Again")]),a("div",{classMap:{output:!0},attrs:{"data-id":"output"},props:{hidden:!0},key:9},[a("div",{classMap:{outputDiv:!0,noQRFound:!0},attrs:{"data-id":"outputMessage"},key:5},[r("No QR code detected.")]),a("div",{classMap:{outputDiv:!0},props:{hidden:!0},key:8},[a("b",{key:6},[r("Data:")]),a("span",{attrs:{"data-id":"outputData"},key:7},[])])])])])]),a("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_2-of-12":!0,"slds-large-size_3-of-12":!0},key:13},[])])]}var o=Object(s.registerTemplate)(n);n.stylesheets=[],r&&n.stylesheets.push.apply(n.stylesheets,r),n.stylesheetTokens={hostAttribute:"my-qrCodeScanner-_qrCodeScanner-host",shadowAttribute:"my-qrCodeScanner-_qrCodeScanner"};var d=i(12),l=i.n(d);class c extends s.LightningElement{constructor(...e){super(...e),this._ui=null,this._data=null,this._isVisible=!1}get isVisible(){return this._isVisible}set isVisible(e){this._data=null,this._isVisible=e,this._isVisible?(this._startVideo(),this._showCaptureData("divCapture")):(this._stopVideo(),this._showCaptureData("divData"))}scanAgain(){this.isVisible=!0}renderedCallback(){this._ui||(this._ui={},this._ui.video=document.createElement("video"),this._ui.canvasElement=this.template.querySelector("[data-id=canvas]"),this._ui.canvas=this._ui.canvasElement.getContext("2d"),this._ui.loadingMessage=this.template.querySelector("[data-id=loadingMessage]"),this._ui.outputContainer=this.template.querySelector("[data-id=output]"),this._ui.outputMessage=this.template.querySelector("[data-id=outputMessage]"),this._ui.outputData=this.template.querySelector("[data-id=outputData]"),this._ui.divs={divCapture:this.template.querySelector('[data-id="divCapture"]'),divData:this.template.querySelector('[data-id="divData"]')},this._ui.loadingMessage.innerText="âŒ› Loading video...")}_tick(){if(this.isVisible){if(this._ui.video.readyState===this._ui.video.HAVE_ENOUGH_DATA)try{this._ui.loadingMessage.hidden=!0,this._ui.canvasElement.hidden=!1,this._ui.outputContainer.hidden=!1,this._ui.canvasElement.height=this._ui.video.videoHeight,this._ui.canvasElement.width=this._ui.video.videoWidth,this._ui.canvas.drawImage(this._ui.video,0,0,this._ui.canvasElement.width,this._ui.canvasElement.height);let e=this._ui.canvas.getImageData(0,0,this._ui.canvasElement.width,this._ui.canvasElement.height),t=l()(e.data,e.width,e.height,{inversionAttempts:"dontInvert"});t&&this._reportData(t)}catch(e){console.log(e)}else this._ui.loadingMessage.hidden=!1,this._ui.canvasElement.hidden=!0,this._ui.outputContainer.hidden=!0;window.requestAnimationFrame(()=>{this._tick()})}}_reportData(e){try{const t=e.data,i=JSON.parse(t);this._drawBox(e),this.isVisible=!1,this._ui.outputMessage.hidden=!0,this._ui.outputData.parentElement.hidden=!1,this._ui.outputData.innerHtml=JSON.stringify(i,null,2),fetch("/reportQRCode",{method:"post",headers:{"Content-Type":"application/json"},body:t}).then(e=>e.json()).then(e=>{console.log(JSON.stringify(e))}).catch(e=>{console.error(e)})}catch(e){console.error(e)}}_drawBox(e){this._drawLine(e.location.topLeftCorner,e.location.topRightCorner),this._drawLine(e.location.topRightCorner,e.location.bottomRightCorner),this._drawLine(e.location.bottomRightCorner,e.location.bottomLeftCorner),this._drawLine(e.location.bottomLeftCorner,e.location.topLeftCorner)}_drawLine(e,t){this._ui.canvas.beginPath(),this._ui.canvas.moveTo(e.x,e.y),this._ui.canvas.lineTo(t.x,t.y),this._ui.canvas.lineWidth=4,this._ui.canvas.strokeStyle="#FF3B58",this._ui.canvas.stroke()}_stopVideo(){this._ui&&this._ui.video&&this._ui.video.srcObject&&this._ui.video.srcObject.getVideoTracks().forEach(e=>e.stop())}_startVideo(){navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(e=>{this._ui.video.srcObject=e,this._ui.video.setAttribute("playsinline",!0),this._ui.video.play(),window.requestAnimationFrame(()=>{this._tick()})}).catch(()=>{alert("Your browser does not support camera, sorry. (1)")}):alert("Your browser does not support camera, sorry. (2)")}_showCaptureData(e){if(this._ui&&this._ui.divs)try{Object.keys(this._ui.divs).forEach(t=>{this._ui.divs[t].hidden=t!==e})}catch(e){console.log(e)}}}Object(s.registerDecorators)(c,{publicProps:{isVisible:{config:3}},fields:["_ui","_data","_isVisible"]});var h=Object(s.registerComponent)(c,{tmpl:o}),u=i(6),p=i.n(u);function g(e,t,i,s){const{h:a}=e;return[a("div",{classMap:{"slds-grid":!0,"slds-wrap":!0,"slds-grid_align-center":!0},styleMap:{height:"100%"},key:2},[a("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-align_absolute-center":!0},key:1},[a("canvas",{attrs:{"data-id":"QRCode"},key:0},[])])])]}var _=Object(s.registerTemplate)(g);g.stylesheets=[],p.a&&g.stylesheets.push.apply(g.stylesheets,p.a),g.stylesheetTokens={hostAttribute:"my-qrCodeGenerator-_qrCodeGenerator-host",shadowAttribute:"my-qrCodeGenerator-_qrCodeGenerator"};var b=i(13),v=i.n(b);class m extends s.LightningElement{constructor(){super(),this.isVisible=!1,setInterval(()=>{this.isVisible&&this.generateQR()},1e3)}generateQR(){const e=this.template.querySelector('[data-id="QRCode"]'),t=JSON.stringify((new Date).getMilliseconds());v.a.toCanvas(e,t,{margin:0,width:.9*Math.min(window.innerWidth,window.innerHeight)}).then(()=>{console.log("Generated QR!")}).catch(e=>{throw Error(e)})}}Object(s.registerDecorators)(m,{publicProps:{isVisible:{config:0}}});var y=Object(s.registerComponent)(m,{tmpl:_});function f(e,t,i,s){const{t:a,b:r,h:n,c:o,gid:d}=e,{_m0:l,_m1:c}=s;return[n("div",{classMap:{"slds-tabs_default":!0,"slds-tabs_large":!0},key:7},[n("ul",{classMap:{"slds-tabs_default__nav":!0},attrs:{role:"tablist"},key:2},[n("li",{classMap:{"slds-tabs_default__item":!0},attrs:{"data-id":"tabScanner"},key:0,on:{click:l||(s._m0=r(t.showScanner))}},[a("Scanner")]),n("li",{classMap:{"slds-tabs_default__item":!0},attrs:{"data-id":"tabGenerator"},key:1,on:{click:c||(s._m1=r(t.showGenerator))}},[a("Generator")])]),n("div",{classMap:{"slds-tabs_default__content":!0,"slds-hide":!0},attrs:{id:d("tab-default-1"),"data-id":"pageScanner"},key:4},[o("my-qr-code-scanner",h,{props:{isVisible:t.isScannerVisible},key:3},[])]),n("div",{classMap:{"slds-tabs_default__content":!0,"slds-hide":!0},attrs:{id:d("tab-default-2"),"data-id":"pageGenerator"},key:6},[o("my-qr-code-generator",y,{props:{isVisible:t.isGeneratorVisible},key:5},[])])]),a("v2.1")]}var w=Object(s.registerTemplate)(f);f.stylesheets=[],a&&f.stylesheets.push.apply(f.stylesheets,a),f.stylesheetTokens={hostAttribute:"my-app-_app-host",shadowAttribute:"my-app-_app"};class k extends s.LightningElement{constructor(){super(),this._initialized=!1,this.pageVisibility={},this.pageVisibility={scanner:!1,generator:!1}}renderedCallback(){if(!this._initialized){this._initialized=!0;let e=new URLSearchParams(window.location.search);switch(e.get("tab")){case"scanner":case"generator":this._switchPage(e.get("tab"));break;default:this._switchPage("scanner")}}}get isScannerVisible(){return this.pageVisibility.scanner}get isGeneratorVisible(){return this.pageVisibility.generator}showScanner(){this._switchPage("scanner")}showGenerator(){this._switchPage("generator")}_getDOM(){return{tabs:{scanner:this.template.querySelector('[data-id="tabScanner"]'),generator:this.template.querySelector('[data-id="tabGenerator"]')},pages:{scanner:this.template.querySelector('[data-id="pageScanner"]'),generator:this.template.querySelector('[data-id="pageGenerator"]')}}}_switchPage(e){let t=this._getDOM();Object.keys(this.pageVisibility).forEach(t=>{this.pageVisibility[t]=t===e}),Object.keys(t.tabs).forEach(i=>{i===e?t.tabs[i].classList.add("slds-is-active"):t.tabs[i].classList.remove("slds-is-active")}),Object.keys(t.pages).forEach(i=>{i===e?(t.pages[i].classList.add("slds-show"),t.pages[i].classList.remove("slds-hide")):(t.pages[i].classList.remove("slds-show"),t.pages[i].classList.add("slds-hide"))})}}Object(s.registerDecorators)(k,{track:{pageVisibility:1},fields:["_initialized"]});var M=Object(s.registerComponent)(k,{tmpl:w});customElements.define("my-app",Object(s.buildCustomElementConstructor)(M))}});